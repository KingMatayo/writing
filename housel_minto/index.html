<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="King Matayo">
<meta name="dcterms.date" content="2024-12-23">

<title>The Housel + Minto Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
      }
</style>


<link rel="stylesheet" href="style.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span style="color:white">The Housel + Minto Approach</span></h1>
            <p class="subtitle lead">A breakdown of the writing style I like the most</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>King Matayo <a href="mailto:kingmatayo.thefirst@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 23, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#housel-as-the-best-student-of-minto" id="toc-housel-as-the-best-student-of-minto" class="nav-link active" data-scroll-target="#housel-as-the-best-student-of-minto">Housel as the best student of Minto</a></li>
  <li><a href="#why-his-writing-is-so-compelling" id="toc-why-his-writing-is-so-compelling" class="nav-link" data-scroll-target="#why-his-writing-is-so-compelling">Why his writing is so compelling</a></li>
  <li><a href="#housels-storytelling-style-in-action" id="toc-housels-storytelling-style-in-action" class="nav-link" data-scroll-target="#housels-storytelling-style-in-action">Housel’s storytelling style in action</a>
  <ul class="collapse">
  <li><a href="#step-1-start-with-a-relatable-anecdote-or-story" id="toc-step-1-start-with-a-relatable-anecdote-or-story" class="nav-link" data-scroll-target="#step-1-start-with-a-relatable-anecdote-or-story">Step 1: Start with a relatable anecdote or story</a></li>
  <li><a href="#step-2-explain-the-concept-with-simplicity" id="toc-step-2-explain-the-concept-with-simplicity" class="nav-link" data-scroll-target="#step-2-explain-the-concept-with-simplicity">Step 2: Explain the concept with simplicity</a></li>
  <li><a href="#step-3-draw-a-universal-insight" id="toc-step-3-draw-a-universal-insight" class="nav-link" data-scroll-target="#step-3-draw-a-universal-insight">Step 3: Draw a universal insight</a></li>
  <li><a href="#step-4-use-a-contrast" id="toc-step-4-use-a-contrast" class="nav-link" data-scroll-target="#step-4-use-a-contrast">Step 4: Use a contrast</a></li>
  <li><a href="#step-5-invite-reflection" id="toc-step-5-invite-reflection" class="nav-link" data-scroll-target="#step-5-invite-reflection">Step 5: Invite reflection</a></li>
  <li><a href="#step-6-end-with-a-memorable-closing" id="toc-step-6-end-with-a-memorable-closing" class="nav-link" data-scroll-target="#step-6-end-with-a-memorable-closing">Step 6: End with a memorable closing</a></li>
  <li><a href="#combining-all-6-stepsparagraphs-into-a-final-story" id="toc-combining-all-6-stepsparagraphs-into-a-final-story" class="nav-link" data-scroll-target="#combining-all-6-stepsparagraphs-into-a-final-story">Combining all 6 steps/paragraphs into a final story</a></li>
  </ul></li>
  <li><a href="#how-barbara-inspired-morgans-style" id="toc-how-barbara-inspired-morgans-style" class="nav-link" data-scroll-target="#how-barbara-inspired-morgans-style">How Barbara inspired Morgan’s style</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="housel-as-the-best-student-of-minto" class="level1">
<h1>Housel as the best student of Minto</h1>
<p>I’m a trained management consultant, and in my profession we are taught the Minto Pyramid Principle - which helps us write more effective and persuasive stories. Now, despite using this Minto approach to breakdown problems and write reports, I had never come across a renowned author, outside of consulting circles, who religiously used the pyramid principle. Not until I came across the books and articles of Morgan Housel.</p>
</section>
<section id="why-his-writing-is-so-compelling" class="level1">
<h1>Why his writing is so compelling</h1>
<p>Morgan Housel’s writing is compelling for so many reasons, and below is a laundry list of why I love his writing style:</p>
<p><strong>Simplicity and Clarity</strong></p>
<ul>
<li>Housel has a gift for explaining complex concepts in plain, accessible language. He avoids jargon and uses metaphors and analogies to make abstract ideas relatable. This makes his writing approachable for a wide audience, regardless of their background or expertise.</li>
</ul>
<p><strong>Anecdote-Driven</strong></p>
<ul>
<li>Stories are at the heart of Housel’s style. He frequently uses anecdotes—both personal and historical—to illustrate key ideas. These stories not only make the content memorable but also help readers connect emotionally to the concepts he’s explaining.</li>
</ul>
<p><strong>Human-Centered Focus</strong></p>
<ul>
<li>His writing revolves around human behavior, psychology, and decision-making. He explores how emotions, biases, and perspectives shape our actions, especially in the context of money, risk, and success. This makes his work deeply relatable and thought-provoking.</li>
</ul>
<p><strong>Concise Yet Reflective</strong></p>
<ul>
<li>Housel’s sentences are short and punchy, but they often carry deep meaning. He carefully crafts his words to maximize impact, leaving readers with “aha moments” after almost every paragraph.</li>
</ul>
<p><strong>Timelessness Over Trendiness</strong></p>
<ul>
<li>Instead of focusing on fleeting trends or niche topics, Housel emphasizes enduring principles. His insights are designed to remain relevant across generations, making his books feel timeless.</li>
</ul>
<p><strong>Wisdom Through Contrast</strong></p>
<ul>
<li>He frequently uses contrasting examples to highlight the nuances of a concept. For instance, he might juxtapose two people making different financial decisions to show how behavior and context influence outcomes more than formulas do.</li>
</ul>
<p><strong>Reflective and Introspective</strong></p>
<ul>
<li>Housel often prompts readers to reflect on their own experiences and beliefs. His writing feels like a conversation, inviting readers to think critically about their assumptions and habits.</li>
</ul>
<p><strong>Optimistic Yet Realistic</strong></p>
<ul>
<li>While Housel doesn’t shy away from discussing challenges, risks, and failures, his overall tone is one of optimism. He emphasizes resilience, adaptability, and the power of learning from setbacks.</li>
</ul>
<p><strong>Repetition with a Purpose</strong></p>
<ul>
<li>He often revisits core ideas throughout his work, reinforcing them with new examples or perspectives. This repetition helps readers internalize the key lessons and see how they apply in different contexts.</li>
</ul>
<p><strong>Unapologetically Personal</strong></p>
<ul>
<li>Housel isn’t afraid to weave in his own experiences and vulnerabilities. By sharing his successes and mistakes, he builds a sense of trust and authenticity with his readers.</li>
</ul>
<p>Morgan Housel’s style is a masterclass in combining storytelling with actionable wisdom. His ability to translate profound truths into simple, relatable stories is what makes his work resonate so deeply with readers.</p>
<p>It’s like sitting down with a wise friend who not only understands the world but also wants to help you navigate it better.</p>
<p>To better understand his style, lets walk through a concrete example:</p>
</section>
<section id="housels-storytelling-style-in-action" class="level1 page-columns page-full">
<h1>Housel’s storytelling style in action</h1>
<p>The topic we’ll explore is <strong>the importance of patience in decision-making</strong> - through the life of Ronald Read.</p>
<p>Housel’s style can be broken down into 6 steps:</p>
<section id="step-1-start-with-a-relatable-anecdote-or-story" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-1-start-with-a-relatable-anecdote-or-story">Step 1: Start with a relatable anecdote or story</h2>
<p>Housel often opens with a vivid story that hooks the reader. The story doesn’t have to be dramatic; it just needs to resonate emotionally:</p>
<div class="column-body-outset">
<p><strong>Example 1:</strong></p>
<p><em>In the 1970s, a young investor named Ronald Read worked as a janitor in a small Vermont town. His life seemed ordinary—unremarkable, even. He lived modestly, drove an old car, and never splurged on luxuries. But when Ronald passed away in 2014, he left behind an $8 million fortune. His secret? Patience.</em></p>
</div>
</section>
<section id="step-2-explain-the-concept-with-simplicity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-2-explain-the-concept-with-simplicity">Step 2: Explain the concept with simplicity</h2>
<p>Introduce the idea behind the story in plain terms. Avoid jargon and keep it concise.</p>
<div class="column-body-outset">
<p><strong>Example 2:</strong></p>
<p><em>Ronald Read’s wealth wasn’t built on winning the lottery or inheriting a fortune. It was built on the power of patience. He invested small amounts of money consistently over decades, letting compound interest do the hard work. Patience, more than talent or timing, turned an ordinary janitor into an extraordinary millionaire.</em></p>
</div>
</section>
<section id="step-3-draw-a-universal-insight" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-3-draw-a-universal-insight">Step 3: Draw a universal insight</h2>
<p>Tie the story to a broader principle that applies to everyone. Housel excels at extracting wisdom that feels timeless and relevant.</p>
<div class="column-body-outset">
<p><strong>Example 3:</strong></p>
<p><em>Patience is often underestimated because its results are invisible in the short term. It’s like planting a tree: for years, you might see little growth. But given time, those small daily increments compound into something extraordinary. Most people abandon their efforts too soon, expecting quick results in a world that rewards the long game.</em></p>
</div>
</section>
<section id="step-4-use-a-contrast" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-4-use-a-contrast">Step 4: Use a contrast</h2>
<p>Highlight the principle by comparing it to an opposing behavior. This sharpens the lesson and makes it memorable.</p>
<div class="column-body-outset">
<p><strong>Example 4:</strong></p>
<p><em>Compare that to the fate of lottery winners. Research shows that many end up bankrupt within a decade, despite receiving millions overnight. Why? Because sudden wealth without patience often leads to reckless decisions. Ronald Read’s story is the opposite: slow and steady, yet enduringly successful.</em></p>
</div>
</section>
<section id="step-5-invite-reflection" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-5-invite-reflection">Step 5: Invite reflection</h2>
<p>Encourage the reader to reflect on their own decisions or beliefs. Housel’s writing often feels like a personal nudge toward introspection.</p>
<div class="column-body-outset">
<p><strong>Example 5:</strong></p>
<p><em>How often do we chase immediate rewards, thinking they’ll solve all our problems? Whether it’s a risky investment, a rushed decision, or a shortcut to success, impatience can derail even the best intentions. What would happen if we embraced patience instead?</em></p>
</div>
</section>
<section id="step-6-end-with-a-memorable-closing" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="step-6-end-with-a-memorable-closing">Step 6: End with a memorable closing</h2>
<p>Finish with a punchy takeaway or a rhetorical flourish that reinforces the lesson.</p>
<div class="column-body-outset">
<p><strong>Example 6:</strong></p>
<p><em>Patience isn’t flashy, but it works. In a world obsessed with speed, Ronald Read’s quiet fortune is a reminder: slow doesn’t just win the race—it changes your life.</em></p>
</div>
</section>
<section id="combining-all-6-stepsparagraphs-into-a-final-story" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="combining-all-6-stepsparagraphs-into-a-final-story">Combining all 6 steps/paragraphs into a final story</h2>
<div class="column-body-outset">
<p><em>In the 1970s, a young investor named Ronald Read worked as a janitor in a small Vermont town. His life seemed ordinary—unremarkable, even. He lived modestly, drove an old car, and never splurged on luxuries. But when Ronald passed away in 2014, he left behind an $8 million fortune. His secret? Patience.</em></p>
<p><em>Ronald Read’s wealth wasn’t built on winning the lottery or inheriting a fortune. It was built on the power of patience. He invested small amounts of money consistently over decades, letting compound interest do the hard work. Patience, more than talent or timing, turned an ordinary janitor into an extraordinary millionaire.</em></p>
<p><em>Patience is often underestimated because its results are invisible in the short term. It’s like planting a tree: for years, you might see little growth. But given time, those small daily increments compound into something extraordinary. Most people abandon their efforts too soon, expecting quick results in a world that rewards the long game.</em></p>
<p><em>Compare that to the fate of lottery winners. Research shows that many end up bankrupt within a decade, despite receiving millions overnight. Why? Because sudden wealth without patience often leads to reckless decisions. Ronald Read’s story is the opposite: slow and steady, yet enduringly successful.</em></p>
<p><em>How often do we chase immediate rewards, thinking they’ll solve all our problems? Whether it’s a risky investment, a rushed decision, or a shortcut to success, impatience can derail even the best intentions. What would happen if we embraced patience instead?</em></p>
<p><em>Patience isn’t flashy, but it works. In a world obsessed with speed, Ronald Read’s quiet fortune is a reminder: slow doesn’t just win the race—it changes your life.</em></p>
</div>
<hr>
</section>
</section>
<section id="how-barbara-inspired-morgans-style" class="level1">
<h1>How Barbara inspired Morgan’s style</h1>
<p>Morgan Housel’s storytelling style adopts alot of Barbara Minto’s <strong>“Pyramid Principle”</strong>, particularly when it comes to structured, clear, and engaging communication.</p>
<p>For instance, the <strong>S.C.Q. framework</strong> (Situation, Complication, Question) that Minto outlines is especially aligned with how Housel begins his stories.</p>
<p>Let’s break this down:</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>